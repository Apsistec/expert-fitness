{"version":3,"sources":["./src/app/_home/products/products.page.scss","./src/app/_home/products/products.page.html","./src/app/_home/products/products.module.ts","./src/app/_home/products/products.page.ts","./src/app/_home/products/products-routing.module.ts","./node_modules/@stripe/stripe-js/dist/stripe.esm.js"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,+EAAgB,+CAA+C,GAAG,gBAAgB,gDAAgD,wBAAwB,GAAG,uBAAuB,kCAAkC,wBAAwB,iDAAiD,GAAG,sBAAsB,yCAAyC,4CAA4C,+BAA+B,6BAA6B,GAAG,iBAAiB,0CAA0C,4CAA4C,8BAA8B,GAAG,6BAA6B,+CAA+C,wCAAwC,+BAA+B,GAAG,6CAA6C,mmDAAmmD,E;;;;;;;;;;;;ACAz4E;AAAe,uvBAAwrB,4KAA4K,gdAAgd,gBAAgB,qHAAqH,iBAAiB,8fAA8f,uBAAuB,2VAA2V,gBAAgB,ugBAAugB,sCAAsC,q6BAAq6B,E;;;;;;;;;;;;;;;;;;;;;;;ACA5vH;AACN;AACyB;AACrB;AACc;AACW;AACvB;IAalC,kBAAkB,SAAlB,kBAAkB;CAAG;AAArB,kBAAkB;IAX9B,8DAAQ,CAAC;QACN,OAAO,EAAE;YACL,4DAAY;YACZ,0DAAW;YACX,kEAAmB;YACnB,0DAAW;YACX,kFAAyB;YACzB,kEAAY;SACf;QACD,YAAY,EAAE,CAAC,2DAAY,CAAC;KAC/B,CAAC;GACW,kBAAkB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnBmB;AACa;AACJ;AACE;AAClB;AAEqB;AACX;AACc;AACpB;IAQlC,YAAY,SAAZ,YAAY;IAQvB,YACU,EAAoB,EACpB,GAAyB,EACzB,WAAwB,EACxB,MAAuB,EACvB,cAA8B;QAJ9B,OAAE,GAAF,EAAE,CAAkB;QACpB,QAAG,GAAH,GAAG,CAAsB;QACzB,gBAAW,GAAX,WAAW,CAAa;QACxB,WAAM,GAAN,MAAM,CAAiB;QACvB,mBAAc,GAAd,cAAc,CAAgB;IACpC,CAAC;IAEL,QAAQ;QACN,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAE,2DAAI,CAAG,CAAC,CAAE,CAAE,CAAC;QAC3D,IAAK,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,EAAG;YACrC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;aAAM;YACL,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;SACvB;IACH,CAAC;IAED,kBAAkB;QAChB,wDAAwD;QACxD,0DAA0D;QAC1D,yDAAyD;QACzD,+BAA+B;QAC/B,iCAAiC;QACjC,WAAW;QACX,qCAAqC;QACrC,mDAAmD;QACnD,wCAAwC;QACxC,gCAAgC;QAChC,kCAAkC;QAClC,kBAAkB;QAClB,gEAAgE;QAChE,iFAAiF;QACjF,kBAAkB;QAClB,UAAU;QACV,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,UAAU,CAAO,UAAU,EAAE,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAE,CAAE;aAC5F,GAAG,EAAE,CAAC;QACL,0DAA0D;QAC1D,2EAA2E;QAC3E,YAAY;IAClB,CAAC;IAEC,sCAAsC;IACtC,8DAA8D;IAC9D,gFAAgF;IAChF,8DAA8D;IAC9D,qDAAqD;IACrD,6BAA6B;IAC7B,4CAA4C;IAC5C,oCAAoC;IACpC,0CAA0C;IAC1C,qDAAqD;IACrD,kDAAkD;IAClD,mCAAmC;IACnC,8CAA8C;IAC9C,0EAA0E;IAC1E,mCAAmC;IACnC,iBAAiB;IACjB,eAAe;IACf,6DAA6D;IAC7D,oCAAoC;IACpC,yCAAyC;IACzC,mEAAmE;IACnE,cAAc;IACd,uCAAuC;IACvC,wDAAwD;IACxD,yCAAyC;IACzC,oCAAoC;IACpC,YAAY;IACZ,wDAAwD;IACxD,sDAAsD;IACtD,2CAA2C;IAC3C,YAAY;IACZ,UAAU;IAEZ,yCAAyC;IACzC,gBAAgB;QACd,MAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,UAAU,CAAE,WAAW,CAAE;aAC/C,GAAG,CAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAE;aAClB,UAAU,CACT,eAAe,EAAE,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAC/B,QAAQ,EAAE,IAAI,EAAE,CAAC,UAAU,EAAE,QAAQ,CAAC,CACvC,CACF,CAAC;QACN,IAAK,QAAQ,IAAI,IAAI,EAAG;YACtB,gBAAgB;YAChB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;SACtB;aAAM;YACL,kEAAkE;YAClE,IAAI,CAAC,aAAa,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;YAC5C,MAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC;YACxD,OAAO;SACR;IACH,CAAC;IAGD,mBAAmB;IACb,SAAS,CAAE,KAAK;;YACpB,KAAK,CAAC,cAAc,EAAE,CAAC;YACvB,MAAM,QAAQ,GAAG,IAAI,QAAQ,CAAE,KAAK,CAAC,MAAM,CAAE,CAAC;YAE9C,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,EAAE;iBACzB,UAAU,CAAE,WAAW,CAAE;iBACzB,GAAG,CAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAE;iBACpB,UAAU,CAAE,mBAAmB,CAAE;iBACjC,GAAG,CAAC;gBACH,KAAK,EAAE,QAAQ,CAAC,GAAG,CAAE,OAAO,CAAE;gBAC9B,qBAAqB,EAAE,IAAI;gBAC3B,SAAS,EAAE,qEAAW,CAAC,QAAQ;gBAC/B,WAAW,EAAE,MAAM,CAAC,QAAQ,CAAC,MAAM;gBACnC,UAAU,EAAE,MAAM,CAAC,QAAQ,CAAC,MAAM;gBAClC,QAAQ,EAAE;oBACR,QAAQ,EAAE,yBAAyB;iBACpC;aACF,CAAC,CAAC;YACL,gEAAgE;YAChE,MAAM,CAAC,UAAU,CAAE,CAAQ,IAAI,EAAG,EAAE,CAAC;gBACnC,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;gBACzC,sEAAsE;gBACtE,IAAK,KAAK,EAAG;oBACX,IAAI,CAAC,cAAc,CAAC,UAAU,CAAE,KAAK,CAAE,CAAC;iBACzC;gBACD,gDAAgD;gBAChD,cAAc;gBACd,IAAK,SAAS,EAAG;oBACf,MAAM,MAAM,GAAG,MAAM,qEAAU,CAAE,qEAAW,CAAC,YAAY,CAAE,CAAC;oBAC5D,MAAM,CAAC,kBAAkB,CAAC,EAAE,SAAS,EAAE,CAAC,CAAC;iBAC1C;YACH,CAAC,EAAC,CAAC;QACL,CAAC;KAAA;IAED,yBAAyB;IACnB,iBAAiB;;YAErB,+BAA+B;YAC/B,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,qDAAqD,CAAC,CAAC;YAClG,MAAM,GAAG,GAAG,MAAM,WAAW,CAAC,EAAE,SAAS,EAAE,MAAM,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC;YACrE,OAAO,GAAG,CAAC;QACb,CAAC;KAAA;IAED,+BAA+B;IAC/B,IAAI,YAAY;QACd,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CACzB,0DAAG,CAAE,IAAI,CAAC,EAAE;YACV,MAAM,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC;QACjC,CAAC,CAAC,CACH,CAAC;QACF,OAAO,IAAI,CAAC,YAAY,CAAC;IAC3B,CAAC;CAEF;;YA7KQ,wEAAgB;YADhB,4EAAoB;YAEpB,yEAAW;YAIX,kEAAe;YACf,gFAAc;;AASV,YAAY;IANxB,+DAAS,CAAC;QACT,QAAQ,EAAE,cAAc;QACxB,gFAAmC;;KAEpC,CAAC;GAEW,YAAY,CA8JxB;AA9JwB;;;;;;;;;;;;;;;;;;;;ACjBgB;AACc;AAER;AAE/C,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,2DAAY;KACxB;CACF,CAAC;IAMW,yBAAyB,SAAzB,yBAAyB;CAAG;AAA5B,yBAAyB;IAJrC,8DAAQ,CAAC;QACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;KACxB,CAAC;GACW,yBAAyB,CAAG;AAAH;;;;;;;;;;;;;AChBtC;AAAA;AAAA;AACA;AACA,uIAAuI;AACvI;AACA;;AAEA,iBAAiB,oBAAoB;AACrC;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,qEAAqE,aAAa;AAClF;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEsB","file":"_home-products-products-module.js","sourcesContent":["export default \".page-content {\\n  --background: var(--ion-color-light-shade);\\n}\\n\\n.page-card {\\n  --background: var(--ion-color-medium-shade);\\n  border-radius: 12px;\\n}\\n\\n.page-card-header {\\n  border: 2px solid transparent;\\n  border-radius: 12px;\\n  --background: var(--ion-color-primary-shade);\\n}\\n\\n.page-card-title {\\n  color: var(--ion-color-warning-tint);\\n  font: 800 16px/1 \\\"Roboto\\\", sans-serif;\\n  text-transform: capitalize;\\n  font-variant: small-caps;\\n}\\n\\n.title-card {\\n  color: var(--ion-color-tertiary-tint);\\n  font: 800 16px/1 \\\"Roboto\\\", sans-serif;\\n  text-transform: uppercase;\\n}\\n\\n.card-subtitle-products {\\n  font: 700 16px/1 \\\"Open Sans\\\", sans-serif;\\n  color: var(--ion-color-light-shade);\\n  text-transform: capitalize;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvX2hvbWUvcHJvZHVjdHMvcHJvZHVjdHMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsMENBQUE7QUFDRjs7QUFDQTtFQUNFLDJDQUFBO0VBQ0EsbUJBQUE7QUFFRjs7QUFDQTtFQUNFLDZCQUFBO0VBQ0EsbUJBQUE7RUFDQSw0Q0FBQTtBQUVGOztBQUNBO0VBQ0Usb0NBQUE7RUFDQSxxQ0FBQTtFQUNBLDBCQUFBO0VBQ0Esd0JBQUE7QUFFRjs7QUFDQTtFQUNFLHFDQUFBO0VBQ0EscUNBQUE7RUFDQSx5QkFBQTtBQUVGOztBQUNBO0VBQ0Usd0NBQUE7RUFDQSxtQ0FBQTtFQUNBLDBCQUFBO0FBRUYiLCJmaWxlIjoic3JjL2FwcC9faG9tZS9wcm9kdWN0cy9wcm9kdWN0cy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIucGFnZS1jb250ZW50IHtcclxuICAtLWJhY2tncm91bmQ6IHZhcigtLWlvbi1jb2xvci1saWdodC1zaGFkZSk7XHJcbn1cclxuLnBhZ2UtY2FyZCB7XHJcbiAgLS1iYWNrZ3JvdW5kOiB2YXIoLS1pb24tY29sb3ItbWVkaXVtLXNoYWRlKTtcclxuICBib3JkZXItcmFkaXVzOiAxMnB4O1xyXG59XHJcblxyXG4ucGFnZS1jYXJkLWhlYWRlciB7XHJcbiAgYm9yZGVyOiAycHggc29saWQgdHJhbnNwYXJlbnQ7XHJcbiAgYm9yZGVyLXJhZGl1czogMTJweDtcclxuICAtLWJhY2tncm91bmQ6IHZhcigtLWlvbi1jb2xvci1wcmltYXJ5LXNoYWRlKTtcclxufVxyXG5cclxuLnBhZ2UtY2FyZC10aXRsZSB7XHJcbiAgY29sb3I6IHZhcigtLWlvbi1jb2xvci13YXJuaW5nLXRpbnQpO1xyXG4gIGZvbnQ6IDgwMCAxNnB4LzEgXCJSb2JvdG9cIiwgc2Fucy1zZXJpZjtcclxuICB0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTtcclxuICBmb250LXZhcmlhbnQ6IHNtYWxsLWNhcHM7XHJcbn1cclxuXHJcbi50aXRsZS1jYXJkIHtcclxuICBjb2xvcjogdmFyKC0taW9uLWNvbG9yLXRlcnRpYXJ5LXRpbnQpO1xyXG4gIGZvbnQ6IDgwMCAxNnB4LzEgXCJSb2JvdG9cIiwgc2Fucy1zZXJpZjtcclxuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xyXG59XHJcblxyXG4uY2FyZC1zdWJ0aXRsZS1wcm9kdWN0cyB7XHJcbiAgZm9udDogNzAwIDE2cHgvMSBcIk9wZW4gU2Fuc1wiLCBzYW5zLXNlcmlmO1xyXG4gIGNvbG9yOiB2YXIoLS1pb24tY29sb3ItbGlnaHQtc2hhZGUpO1xyXG4gIHRleHQtdHJhbnNmb3JtOiBjYXBpdGFsaXplO1xyXG59XHJcbiJdfQ== */\";","export default \"<app-header></app-header>\\n<ion-content fullscreen class=\\\"page-content\\\">\\n  <ion-grid>\\n    <ion-row>\\n      <ion-col size=\\\"12\\\">\\n        <ion-card color=\\\"secondary\\\" class=\\\"title-card ion-text-center ion-padding \\\">\\n          <ion-card-title class=\\\"page-card-title\\\">\\n            <ion-text>\\n              <h1>Pricing Plans</h1>\\n            </ion-text>\\n          </ion-card-title>\\n          <ion-card-subtitle class=\\\"card-subtitle-products\\\">\\n            <ion-text>\\n              <h4>Choose one of our Awesome plans</h4>\\n            </ion-text>\\n          </ion-card-subtitle>\\n        </ion-card>\\n      </ion-col>\\n    </ion-row>\\n\\n    <ng-component *ngIf=\\\"signedIn == true; else getSignedIn\\\">\\n\\n      <ion-row class=\\\"ion-justify-content-around\\\">\\n        <ng-component *ngIf=\\\"user && user.subStatus !== 'active' || 'trialing' then purchase; else paid\\\">\\n            <ion-spinner>Loading...</ion-spinner>\\n\\n          <ion-col #purchase size=\\\"12\\\" size-md=\\\"3\\\" *ngFor=\\\"let product of products\\\" class=\\\"ion-text-left ion-align-self-stretch\\\">\\n            <ion-card class=\\\"ion-padding page-card\\\">\\n              <ion-card-header class=\\\"page-card-header\\\">\\n                <ion-card-title class=\\\"page-card-title\\\">\\n                  <ion-text class=\\\"ion-text-start\\\">\\n                    <h3>{{ product.name }}</h3>\\n                  </ion-text>\\n                  <ion-text class=\\\"ion-text-end\\\">\\n                    <h2>{{ product.price }}</h2>\\n                  </ion-text>\\n                </ion-card-title>\\n\\n              </ion-card-header>\\n              <ion-card-content>\\n              <hr/>\\n              <ion-list style=\\\"border-radius: 12px\\\">\\n                <ion-list-header class=\\\"list-header-global\\\">\\n                  <ion-title>\\n                    <ion-text> Features: </ion-text>\\n                  </ion-title>\\n                </ion-list-header>\\n                <ion-item>\\n                  <p>\\n                    {{ product.description }}\\n                  </p>\\n                </ion-item>\\n              </ion-list>\\n            </ion-card-content>\\n            <ion-footer class=\\\"ion-text-center ion-padding\\\">\\n              <ion-button\\n                color=\\\"tertiary\\\"\\n                size=\\\"large\\\"\\n                (click)=\\\"subscribe()\\\"\\n                >Subscribe to {{ product.name }}</ion-button>\\n              </ion-footer>\\n            </ion-card>\\n          </ion-col>\\n\\n            <ng-template #paid>\\n              <ion-col>\\n                <ion-card>\\n                  <ion-card-title>\\n                    <ion-text>\\n                      <h2>My subscription</h2>\\n                    </ion-text>\\n                  </ion-card-title>\\n                  <ion-card-content>\\n                    <ion-text>\\n                      <h2>\\n                        <!-- You are currently paying {{ subscription.unit_price | currency }} -->\\n                      </h2>\\n                    </ion-text>\\n                    <ion-text>\\n                      <h2>Stripe Customer Portal</h2>\\n                    </ion-text>\\n                    <ion-text>\\n                      <h3>View invoices, update subscription & payment methods</h3>\\n                    </ion-text>\\n                    <ion-button color=\\\"tertiary\\\" routerLink=\\\"\\\">\\n                      <ion-text>\\n                        Access Customer Portal\\n                      </ion-text>\\n                    </ion-button>\\n                  </ion-card-content>\\n                </ion-card>\\n              </ion-col>\\n            </ng-template>\\n        </ng-component>\\n      </ion-row>\\n\\n      <ng-template #getSignedIn>\\n\\n        <ion-row>\\n        <ion-col>\\n\\n        </ion-col>\\n      </ion-row>\\n    </ng-template>\\n    </ng-component>\\n\\n\\n  </ion-grid>\\n</ion-content>\\n\\n\\n\\n\\n\\n\\n\\n\\n\";","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { SharedModule } from '../../_shared/shared.module';\nimport { ProductsPageRoutingModule } from './products-routing.module';\nimport { ProductsPage } from './products.page';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        IonicModule,\n        ProductsPageRoutingModule,\n        SharedModule,\n    ],\n    declarations: [ProductsPage],\n})\nexport class ProductsPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { AngularFireFunctions } from '@angular/fire/functions';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { AuthService } from 'src/app/_services/auth.service';\nimport { map, take } from 'rxjs/operators';\nimport { User } from '../../_models/users.model';\nimport { environment } from '../../../environments/environment';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { MessageService } from 'src/app/_services/message.service';\nimport { loadStripe } from '@stripe/stripe-js';\n\n@Component({\n  selector: 'app-products',\n  templateUrl: './products.page.html',\n  styleUrls: ['./products.page.scss'],\n})\n\nexport class ProductsPage implements OnInit {\n\n  user: User;\n  role;\n  signedIn;\n  products;\n  subscriptions;\n\n  constructor(\n    private db: AngularFirestore,\n    private fun: AngularFireFunctions,\n    private authService: AuthService,\n    private afAuth: AngularFireAuth,\n    private messageService: MessageService\n  ) { }\n\n  ngOnInit() {\n    this.user = this.authService.authState$.pipe( take ( 1 ) );\n    if ( this.user && this.user !== null ) {\n      this.signedIn = true;\n      this.startDataListeners();\n    } else {\n      this.signedIn = false;\n    }\n  }\n\n  startDataListeners() {\n    //   // Get all our products and render them to the page\n    //   const products = document.querySelector('.products');\n    //   const template = document.querySelector('#product');\n    // this.db.collection<products>\n    //   .where('active', '==', true)\n    //   .get()\n    //   .then(function (querySnapshot) {\n    //     querySnapshot.forEach(async function (doc) {\n    //       const priceSnap = await doc.ref\n    //         .collection('prices')\n    //         .orderBy('unit_amount')\n    //         .get();\n    //       if (!'content' in document.createElement('template')) {\n    //         console.error('Your browser doesn’t support HTML template elements.');\n    //         return;\n    //       }\n    this.products = this.db.collection<any>( 'products', ref => ref.where( 'active', '==', true ) )\n      .get();\n        // if (!'content' in document.createElement('template')) {\n        //   console.error('Your browser doesn’t support HTML template elements.');\n        //   return;\n  }\n\n    //         const product = doc.data();\n    //         const container = template.content.cloneNode(true);\n    //         container.querySelector('h2').innerText = product.name.toUpperCase();\n    //         container.querySelector('.description').innerText =\n    //           product.description.toUpperCase() || '';\n    //         // Prices dropdown\n    //         priceSnap.docs.forEach((doc) => {\n    //           const priceId = doc.id;\n    //           const priceData = doc.data();\n    //           const content = document.createTextNode(\n    //             `${new Intl.NumberFormat('en-US', {\n    //               style: 'currency',\n    //               currency: priceData.currency,\n    //             }).format((priceData.unit_amount / 100).toFixed(2))} per ${\n    //               priceData.interval\n    //             }`\n    //           );\n    //           const option = document.createElement('option');\n    //           option.value = priceId;\n    //           option.appendChild(content);\n    //           container.querySelector('#price').appendChild(option);\n    //         });\n    //         if (product.images.length) {\n    //           const img = container.querySelector('img');\n    //           img.src = product.images[0];\n    //           img.alt = product.name;\n    //         }\n    //         const form = container.querySelector('form');\n    //         form.addEventListener('submit', subscribe);\n    //         products.appendChild(container);\n    //       });\n    //     });\n\n  // Get all subscriptions for the customer\n  getSubscriptions() {\n    const snapshot = this.db.collection( 'customers' )\n      .doc( this.user.uid )\n        .collection(\n          'subscriptions', ref => ref.where(\n            'status', 'in', ['trialing', 'active']\n          )\n        );\n    if ( snapshot == null ) {\n      // Show products\n      this.products = true;\n    } else {\n      // In this implementation we only expect one Subscription to exist\n      this.subscriptions = snapshot.doc[0].data();\n      const priceData = this.subscriptions.price.get().data();\n      return;\n    }\n  }\n\n\n  // Checkout handler\n  async subscribe( event ) {\n    event.preventDefault();\n    const formData = new FormData( event.target );\n\n    const docRef = await this.db\n      .collection( 'customers' )\n      .doc( this.user.uid )\n      .collection( 'checkout_sessions' )\n      .add({\n        price: formData.get( 'price' ),\n        allow_promotion_codes: true,\n        tax_rates: environment.taxRates,\n        success_url: window.location.origin,\n        cancel_url: window.location.origin,\n        metadata: {\n          tax_rate: '10% sales tax exclusive',\n        },\n      });\n    // Wait for the CheckoutSession to get attached by the extension\n    docRef.onSnapshot( async ( snap ) => {\n      const { error, sessionId } = snap.data();\n      // Show an error to your customer and then inspect your function logs.\n      if ( error ) {\n        this.messageService.errorAlert( error );\n      }\n      // We have a session, let's redirect to Checkout\n      // Init Stripe\n      if ( sessionId ) {\n        const stripe = await loadStripe( environment.stripePubKey );\n        stripe.redirectToCheckout({ sessionId });\n      }\n    });\n  }\n\n  // Billing portal handler\n  async openBillingPortal() {\n\n    // Call billing portal function\n    const functionRef = this.fun.httpsCallable('ext-firestore-stripe-subscriptions-createPortalLink');\n    const url = await functionRef({ returnUrl: window.location.origin });\n    return url;\n  }\n\n  // Get custom claim role helper\n  get customerRole() {\n    this.authService.user$.pipe(\n      map( user => {\n        const customerRole = user.role;\n      })\n    );\n    return this.customerRole;\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ProductsPage } from './products.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ProductsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProductsPageRoutingModule {}\n","var V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.11.0\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n};\n\n// own script injection.\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now();\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n"],"sourceRoot":"webpack:///"}